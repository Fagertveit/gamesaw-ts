<!DOCTYPE html>
<html>
<head>
    <title>GameSaw Game Library</title>
    <script src="../../dist/gamesaw.js"></script>
    <style>
        .container {
            width: 800px;
            margin: 10px auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>GameSaw Game Library</h1>
        <div id="gamesaw-container">

        </div>
    </div>

<script>
    var app = new gamesaw.Application(800, 600, 30);
    var testScene = app.sceneManager.addScene('test');
    testScene.add3dSurface('test');
    var gl = testScene.getContext('test');
    gl.clearColor(0, 0, 0, 1);
    var renderer = new gamesaw.GL.Render2d.Renderer2d(gl);
    var frameBuffer = new gamesaw.GL.Render2d.FrameBuffer(gl, 1024, 1024);
    var texture = new gamesaw.GL.Texture(gl, '../img/pixel.png');
    var sprite = new gamesaw.GL.Sprite(texture, 64, 64);
    var scale = 1.0;
    var angle = 0;
    var scaleUp = true;
    sprite.setUV(0.0, 0.0, 1.0, 1.0);

    testScene.render = function(delta) {
        if (texture.ready) {
            sprite.renderAngleScale(renderer, 300, 200, angle, scale);

            sprite.renderScale(renderer, 400, 100, scale);
        }
        gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffer.fbo);
        this.clear('test');
        gl.clearColor(0, 0, 0, 1);
        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
        renderer.execute();
        gl.bindFramebuffer(gl.FRAMEBUFFER, null);

        this.clear('test');
        gl.clearColor(0, 0, 0, 1);
        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);

        var fboTexture = new gamesaw.GL.Texture(gl);
        fboTexture.texture = frameBuffer.texture;
        fboTexture.width = 1024;
        fboTexture.height = 1024;
        fboTexture.ready = true;
        var fboSprite = new gamesaw.GL.Sprite(fboTexture, 400, 300);
        fboSprite.setUVByPixels(0, 0, 800, 600);
        fboSprite.render(renderer, 0, 0);
        renderer.execute();
    };
    testScene.update = function(delta) {
        angle += 5;
        if (scale > 5 && scaleUp) {
            scaleUp = false;
        }

        if (scale < 0.2 && !scaleUp) {
            scaleUp = true;
        }

        if (scaleUp) {
            scale += 0.2;
        } else {
            scale -= 0.2;
        }
    };

    app.init();
</script>
</body>
</html>
